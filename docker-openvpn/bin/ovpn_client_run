#!/bin/bash

#
# Run an OpenVPN client
#

if [ "$DEBUG" == "1" ]; then
  set -x
fi

set -e

cd $OPENVPN

# Build runtime arguments array based on environment
USER_ARGS=("${@}")

# Setup the tunnel network interface device.
mkdir -p /dev/net
if [ ! -c /dev/net/tun ]; then
    mknod /dev/net/tun c 10 200
fi


# When using --net=host, use this to specify nat device.
[ -z "$OVPN_NATDEVICE" ] && OVPN_NATDEVICE=eth0


echo "Running 'openvpn ${USER_ARGS[@]}"
exec openvpn ${USER_ARGS[@]}
